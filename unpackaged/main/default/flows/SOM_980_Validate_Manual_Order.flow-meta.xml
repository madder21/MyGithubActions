<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Create_Credit_Memo</name>
        <label>Create Credit Memo</label>
        <locationX>25</locationX>
        <locationY>834</locationY>
        <actionName>createCreditMemoOrderSummary</actionName>
        <actionType>createCreditMemoOrderSummary</actionType>
        <connector>
            <targetReference>Get_ODG</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>creditMemoInput</name>
            <value>
                <elementReference>S_CreateCreditMemoInputRepresentation</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>orderSummaryId</name>
            <value>
                <elementReference>recordId.OriginalOrderSummary__c</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>S_CreateCreditMemoOutputRepresentation</assignToReference>
            <name>creditMemoOutput</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>Return_Return_Order_Items</name>
        <label>Return Return Order Items</label>
        <locationX>275</locationX>
        <locationY>622</locationY>
        <actionName>returnReturnOrderItems</actionName>
        <actionType>returnReturnOrderItems</actionType>
        <connector>
            <targetReference>Assign_Credit_Memo_Input_Representation</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>returnItemsInput</name>
            <value>
                <elementReference>S_ReturnItemsInputRepresentation</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>returnOrderId</name>
            <value>
                <elementReference>recordId.OriginalReturnOrder__c</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>S_ReturnItemsOutputRepresentation</assignToReference>
            <name>returnItemsOutput</name>
        </outputParameters>
    </actionCalls>
    <apiVersion>55.0</apiVersion>
    <assignments>
        <name>Add_to_collection</name>
        <label>Add to collection</label>
        <locationX>50</locationX>
        <locationY>246</locationY>
        <assignmentItems>
            <assignToReference>LP1_ROLI.FollowUpProcessed__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>C_ROLItoUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>LP1_ROLI</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>LP2_Order_Items</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_CM_Fields</name>
        <label>Assign CM Fields</label>
        <locationX>569</locationX>
        <locationY>990</locationY>
        <assignmentItems>
            <assignToReference>S_CMtoUpdate.PDFGenerationStatus__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Not Started</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_CMtoUpdate.ReturnOrder__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId.OriginalReturnOrder__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_CM</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_CM_Lines_Fields</name>
        <label>Assign CM Lines Fields</label>
        <locationX>872</locationX>
        <locationY>1333</locationY>
        <assignmentItems>
            <assignToReference>S_CreditMemoLineToUpdate.ReturnOrderLineItem__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LP4_ROLIS_To_Map.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_CreditMemoLineToUpdate.Reason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Exchange</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_CreditMemoLineToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LP3_Credit_Memo_Lines.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>C_CMLinesToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>S_CreditMemoLineToUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>LP3_Credit_Memo_Lines</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_CM_Number_1</name>
        <label>Assign CM Number #1</label>
        <locationX>410</locationX>
        <locationY>992</locationY>
        <assignmentItems>
            <assignToReference>S_CMtoUpdate.CreditMemoNumber</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FX_CMNumber</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_CMtoUpdate.DocumentNumber__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FX_CMNumber</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_CM_Fields</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_CM_Number_2</name>
        <label>Assign CM Number #2</label>
        <locationX>570</locationX>
        <locationY>832</locationY>
        <assignmentItems>
            <assignToReference>S_CMtoUpdate.CreditMemoNumber</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FX_First_Credit_Memo_Ever_Created</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_CMtoUpdate.DocumentNumber__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FX_First_Credit_Memo_Ever_Created</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_CM_Fields</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Credit_Memo_Input_Representation</name>
        <label>Assign Credit Memo Input Representation</label>
        <locationX>25</locationX>
        <locationY>622</locationY>
        <assignmentItems>
            <assignToReference>S_CreateCreditMemoInputRepresentation.changeOrderIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>S_ReturnItemsOutputRepresentation.changeOrderId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Credit_Memo</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Return_Order_Item_Input_Representation</name>
        <label>Assign Return Order Item Input Representation</label>
        <locationX>49</locationX>
        <locationY>31</locationY>
        <assignmentItems>
            <assignToReference>S_ReturnOrderItemInputRepresentation.returnOrderLineItemId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LP1_ROLI.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_ReturnOrderItemInputRepresentation.quantityReceived</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LP1_ROLI.QuantityReceived</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_ReturnOrderItemInputRepresentation.quantityRejected</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LP1_ROLI.QuantityRejected</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_ReturnOrderItemInputRepresentation.quantityReturned</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LP1_ROLI.QuantityReceived</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>S_ReturnOrderItemInputRepresentation.quantityToCancel</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LP1_ROLI.QuantityRejected</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>C_ReturnOrderItemInputRepresentation</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>S_ReturnOrderItemInputRepresentation</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Return_Order_Item_Input_Representation</name>
        <label>Return Order Item Input Representation</label>
        <locationX>638</locationX>
        <locationY>622</locationY>
        <assignmentItems>
            <assignToReference>S_ReturnItemsInputRepresentation.returnOrderItems</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>C_ReturnOrderItemInputRepresentation</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Return_Return_Order_Items</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Check_Order_Summary_Status</name>
        <label>Check Order Summary Status</label>
        <locationX>1147</locationX>
        <locationY>641</locationY>
        <defaultConnector>
            <targetReference>Success_Message_Screen</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Is_Waiting_For_Goods</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Order_Summary.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Waiting for goods</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Message_Screen</targetReference>
            </connector>
            <label>Is Waiting For Goods?</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Original_Return_Order</name>
        <label>Check Original Return Order</label>
        <locationX>1229</locationX>
        <locationY>428</locationY>
        <defaultConnector>
            <targetReference>Get_Order_Summary</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Is Empty</defaultConnectorLabel>
        <rules>
            <name>Is_Not_Empty</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.OriginalReturnOrder__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Already_Closed_0</targetReference>
            </connector>
            <label>Is Not Empty</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_ROLI_is_in_OS</name>
        <label>Check ROLI is in OS</label>
        <locationX>316</locationX>
        <locationY>32</locationY>
        <defaultConnector>
            <targetReference>LP2_Order_Items</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>LP1_ROLI.Id</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>LP2_Order_Items.Exchanged_from_ROLI__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Return_Order_Item_Input_Representation</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Already_Closed</name>
        <label>Is Already Closed?</label>
        <locationX>966</locationX>
        <locationY>904</locationY>
        <defaultConnector>
            <targetReference>Close_Return_Order</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.OriginalReturnOrder__r.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Order_Summary</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Already_Closed_0</name>
        <label>Is Already Closed?</label>
        <locationX>967</locationX>
        <locationY>423</locationY>
        <defaultConnector>
            <targetReference>Get_Order_Items</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Closed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.OriginalReturnOrder__r.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Order_Summary</targetReference>
            </connector>
            <label>Closed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Previous_CM_Exist</name>
        <label>Previous CM Exist</label>
        <locationX>408</locationX>
        <locationY>833</locationY>
        <defaultConnector>
            <targetReference>Assign_CM_Number_2</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Last_CM_Created_for_country</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_CM_Number_1</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>ROLI_Match_CML</name>
        <label>ROLI Match CML?</label>
        <locationX>865</locationX>
        <locationY>1063</locationY>
        <defaultConnector>
            <targetReference>LP4_ROLIS_To_Map</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes3</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>LP3_Credit_Memo_Lines.Product2.Id</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>LP4_ROLIS_To_Map.Product2.Id</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_CM_Lines_Fields</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <description>Launch new Credit Memo for Cegid Event</description>
    <environments>Default</environments>
    <formulas>
        <name>FX_CMNumber</name>
        <dataType>String</dataType>
        <expression>SUBSTITUTE({!Get_Last_CM_Created_for_country.DocumentNumber__c}, {!FX_LastCMNumberAdapted}, TEXT({!FX_NewCMNumber}))</expression>
    </formulas>
    <formulas>
        <name>FX_First_Credit_Memo_Ever_Created</name>
        <dataType>String</dataType>
        <expression>&quot;CM000001&quot; + {!Get_ODG.DeliverToCountry}</expression>
    </formulas>
    <formulas>
        <name>FX_LastCMNumber</name>
        <dataType>Number</dataType>
        <expression>VALUE(SUBSTITUTE(SUBSTITUTE({!Get_Last_CM_Created_for_country.DocumentNumber__c}, &quot;CM&quot;, &quot;&quot;),{!Get_ODG.DeliverToCountry} , &quot;&quot;))</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>FX_LastCMNumberAdapted</name>
        <dataType>String</dataType>
        <expression>IF(LEN(TEXT({!FX_LastCMNumber})) &lt; LEN(TEXT({!FX_NewCMNumber})), &quot;0&quot;+TEXT({!FX_LastCMNumber}), TEXT({!FX_LastCMNumber}))</expression>
    </formulas>
    <formulas>
        <name>FX_NewCMNumber</name>
        <dataType>Number</dataType>
        <expression>{!FX_LastCMNumber} + 1</expression>
        <scale>0</scale>
    </formulas>
    <interviewLabel>SOM 980 - Validate Manual Order {!$Flow.CurrentDateTime}</interviewLabel>
    <label>SOM 980 - Validate Manual Order</label>
    <loops>
        <name>LP1_ROLI</name>
        <label>LP1 ROLI</label>
        <locationX>640</locationX>
        <locationY>240</locationY>
        <collectionReference>Get_ROLI</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>LP2_Order_Items</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Follow_up_Processed_To_True_For_Exchange_Line_Items</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>LP2_Order_Items</name>
        <label>LP2 Order Items</label>
        <locationX>325</locationX>
        <locationY>246</locationY>
        <collectionReference>Get_Order_Items</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_ROLI_is_in_OS</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>LP1_ROLI</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>LP3_Credit_Memo_Lines</name>
        <label>LP3 Credit Memo Lines</label>
        <locationX>696</locationX>
        <locationY>1331</locationY>
        <collectionReference>Get_CM_Lines</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>LP4_ROLIS_To_Map</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_CM_Lines</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>LP4_ROLIS_To_Map</name>
        <label>LP4 ROLIS To Map</label>
        <locationX>690</locationX>
        <locationY>1061</locationY>
        <collectionReference>Get_ROLI</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>ROLI_Match_CML</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>LP3_Credit_Memo_Lines</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Publish_Created_Credit_Memo_Event</name>
        <label>Publish Created Credit Memo Event</label>
        <locationX>975</locationX>
        <locationY>1582</locationY>
        <connector>
            <targetReference>Publish_New_Credit_memo_for_Cegid_Event</targetReference>
        </connector>
        <inputAssignments>
            <field>CreditMemoId__c</field>
            <value>
                <elementReference>S_CreateCreditMemoOutputRepresentation.creditMemoId</elementReference>
            </value>
        </inputAssignments>
        <object>CreditMemoCreated__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Publish_New_Credit_memo_for_Cegid_Event</name>
        <label>Publish New Credit memo for Cegid Event</label>
        <locationX>975</locationX>
        <locationY>1414</locationY>
        <connector>
            <targetReference>Is_Already_Closed</targetReference>
        </connector>
        <inputAssignments>
            <field>CreditMemoId__c</field>
            <value>
                <elementReference>S_CreateCreditMemoOutputRepresentation.creditMemoId</elementReference>
            </value>
        </inputAssignments>
        <object>NewCreditMemoForCegid__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_CM_Created</name>
        <label>Get CM Created</label>
        <locationX>156</locationX>
        <locationY>834</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Last_CM_Created_for_country</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>S_CreateCreditMemoOutputRepresentation.creditMemoId</elementReference>
            </value>
        </filters>
        <object>CreditMemo</object>
        <outputReference>S_CMtoUpdate</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>DocumentNumber</queriedFields>
        <sortField>Id</sortField>
        <sortOrder>Asc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>Get_CM_Lines</name>
        <label>Get CM Lines</label>
        <locationX>569</locationX>
        <locationY>1335</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>LP3_Credit_Memo_Lines</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>CreditMemoId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>S_CreateCreditMemoOutputRepresentation.creditMemoId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>CreditMemoLine</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Last_CM_Created_for_country</name>
        <label>Get Last CM Created for country</label>
        <locationX>281</locationX>
        <locationY>833</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Previous_CM_Exist</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DocumentNumber__c</field>
            <operator>EndsWith</operator>
            <value>
                <elementReference>Get_ODG.DeliverToCountry</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>CreditMemo</object>
        <sortField>DocumentNumber__c</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_ODG</name>
        <label>Get ODG</label>
        <locationX>32</locationX>
        <locationY>1032</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_CM_Created</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderSummaryId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OrderDeliveryGroupSummary</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Order_Items</name>
        <label>Get Order Items</label>
        <locationX>974</locationX>
        <locationY>241</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_ROLI</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderSummaryId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItemSummary</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Order_Summary</name>
        <label>Get Order Summary</label>
        <locationX>978</locationX>
        <locationY>629</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_Order_Summary_Status</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OrderSummary</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Status</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_ROLI</name>
        <label>Get ROLI</label>
        <locationX>807</locationX>
        <locationY>241</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>LP1_ROLI</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ReturnOrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.OriginalReturnOrder__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>RepaymentMethod</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Exchange</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ReturnOrderLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordRollbacks>
        <name>RollBack</name>
        <label>RollBack</label>
        <locationX>455</locationX>
        <locationY>415</locationY>
        <connector>
            <targetReference>ErrorScreen</targetReference>
        </connector>
    </recordRollbacks>
    <recordUpdates>
        <name>Update_CM</name>
        <label>Update CM</label>
        <locationX>569</locationX>
        <locationY>1169</locationY>
        <connector>
            <targetReference>Get_CM_Lines</targetReference>
        </connector>
        <inputReference>S_CMtoUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_CM_Lines</name>
        <label>Update CM Lines</label>
        <locationX>697</locationX>
        <locationY>1582</locationY>
        <connector>
            <targetReference>Publish_Created_Credit_Memo_Event</targetReference>
        </connector>
        <inputReference>C_CMLinesToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Follow_up_Processed_To_True_For_Exchange_Line_Items</name>
        <label>Update Follow up Processed To True For Exchange Line Items</label>
        <locationX>638</locationX>
        <locationY>409</locationY>
        <connector>
            <targetReference>Return_Order_Item_Input_Representation</targetReference>
        </connector>
        <faultConnector>
            <targetReference>RollBack</targetReference>
        </faultConnector>
        <inputReference>C_ROLItoUpdate</inputReference>
    </recordUpdates>
    <screens>
        <name>Error_Message_Screen</name>
        <label>Error Message Screen</label>
        <locationX>1380</locationX>
        <locationY>638</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>errorMessage</name>
            <fieldText>&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong style=&quot;font-size: 16px;&quot;&gt;No stock available for this order.&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>ErrorScreen</name>
        <label>ErrorScreen</label>
        <locationX>309</locationX>
        <locationY>413</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>CannotValidate</name>
            <fieldText>&lt;p style=&quot;text-align: center;&quot;&gt;❌ &lt;/p&gt;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong style=&quot;font-size: 14px;&quot;&gt;We can&#39;t validate this exchange order because a previous one is already validated for the specified return item.&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Success_Message_Screen</name>
        <label>Success Message Screen</label>
        <locationX>1152</locationX>
        <locationY>842</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>successMessage</name>
            <fieldText>&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong style=&quot;font-size: 16px;&quot;&gt;Validation has been executed successfully.&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>1047</locationX>
        <locationY>208</locationY>
        <connector>
            <targetReference>Create_Fulfillment_Order</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Close_Return_Order</name>
        <label>Close Return Order</label>
        <locationX>788</locationX>
        <locationY>626</locationY>
        <connector>
            <targetReference>Get_Order_Summary</targetReference>
        </connector>
        <flowName>SOM_830_Close_Return_Order</flowName>
        <inputAssignments>
            <name>recordId</name>
            <value>
                <elementReference>recordId.OriginalReturnOrder__c</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>Create_Fulfillment_Order</name>
        <label>Create Fulfillment Order</label>
        <locationX>1362</locationX>
        <locationY>426</locationY>
        <connector>
            <targetReference>Check_Original_Return_Order</targetReference>
        </connector>
        <flowName>SOM_200_StoreToWeb_Manual_Order_Create_FulfillementOrder_Order</flowName>
        <inputAssignments>
            <name>OrderSummaryRecord</name>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <variables>
        <name>C_CMLinesToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>CreditMemoLine</objectType>
    </variables>
    <variables>
        <name>C_ReturnOrderItemInputRepresentation</name>
        <apexClass>ConnectApi__ReturnOrderItemInputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>C_ROLItoUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ReturnOrderLineItem</objectType>
    </variables>
    <variables>
        <name>currentItem_ROLI_Filter</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ReturnOrderLineItem</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderSummary</objectType>
    </variables>
    <variables>
        <name>S_CMtoUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>CreditMemo</objectType>
    </variables>
    <variables>
        <name>S_CreateCreditMemoInputRepresentation</name>
        <apexClass>ConnectApi__CreateCreditMemoInputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>S_CreateCreditMemoOutputRepresentation</name>
        <apexClass>ConnectApi__CreateCreditMemoOutputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>S_CreditMemoLineToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>CreditMemoLine</objectType>
    </variables>
    <variables>
        <name>S_ReturnItemsInputRepresentation</name>
        <apexClass>ConnectApi__ReturnItemsInputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>S_ReturnItemsOutputRepresentation</name>
        <apexClass>ConnectApi__ReturnItemsOutputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>S_ReturnOrderItemInputRepresentation</name>
        <apexClass>ConnectApi__ReturnOrderItemInputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
