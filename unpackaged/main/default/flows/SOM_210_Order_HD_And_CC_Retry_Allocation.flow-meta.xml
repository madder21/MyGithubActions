<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Get_Inventory_Availability</name>
        <label>Get Inventory Availability</label>
        <locationX>1728</locationX>
        <locationY>1080</locationY>
        <actionName>ociGetAvailability</actionName>
        <actionType>ociGetAvailability</actionType>
        <connector>
            <targetReference>L20_Iterate_Over_Get_Inventory_Availability</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>ociGetAvailabilityInput</name>
            <value>
                <elementReference>REC_OCIGetInventoryAvailabilityInputRepresentation</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>REC_OCIGetInventoryAvailabilityOutputRepresentation</assignToReference>
            <name>ociGetAvailabilityOutput</name>
        </outputParameters>
    </actionCalls>
    <apiVersion>55.0</apiVersion>
    <assignments>
        <name>Add_Allocated_Qty</name>
        <label>Add Allocated Qty</label>
        <locationX>1915</locationX>
        <locationY>526</locationY>
        <assignmentItems>
            <assignToReference>Allocated_Qty</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>L22_Allocated_OSLIs.QuantityAllocated</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>L22_Allocated_OSLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Location_Identifer_To_Collection</name>
        <label>Add Location Identifer To Collection</label>
        <locationX>1988</locationX>
        <locationY>169</locationY>
        <assignmentItems>
            <assignToReference>COL_LocationIdentifiers</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>L12_Iterate_Over_Filtered_Location.ExternalReference</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>L12_Iterate_Over_Filtered_Location</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_SKU_to_Collection</name>
        <label>Add SKU to Collection</label>
        <locationX>1695</locationX>
        <locationY>503</locationY>
        <assignmentItems>
            <assignToReference>COL_SockKeepingUnit</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>L10_Iterate_Over_Order_Item_Summaries.StockKeepingUnit</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>L10_Iterate_Over_Order_Item_Summaries</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_PE</name>
        <label>Assign PE</label>
        <locationX>2427</locationX>
        <locationY>1611</locationY>
        <assignmentItems>
            <assignToReference>V_ProcessExceptionToCreate.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FX_PEDescription</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>V_ProcessExceptionToCreate.AttachedToId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>L22_Iterate_Over_Order_Iem_Summaries.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>V_ProcessExceptionToCreate.Category</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Fulfillment</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>V_ProcessExceptionToCreate.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>New</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>V_ProcessExceptionToCreate.OrderSummaryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>L22_Iterate_Over_Order_Iem_Summaries.OrderSummary.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>V_ProcessExceptionToCreate.Severity</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>High</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>V_ProcessExceptionToCreate.Message</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Insufficient Stock</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>V_ProcessExceptionToCreate.Priority</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>High</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Process_Exceptions</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Reset_Allocated_Qty</name>
        <label>Reset Allocated Qty</label>
        <locationX>2250</locationX>
        <locationY>680</locationY>
        <assignmentItems>
            <assignToReference>Allocated_Qty</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_All_Allocated_OSLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Current_Inventory</name>
        <label>Set Current Inventory</label>
        <locationX>2781</locationX>
        <locationY>1067</locationY>
        <assignmentItems>
            <assignToReference>COL_InventoryRecordForCurrentItem</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Check_OCI_Stock</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>isStockSufficentForItem</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Existing_Process_Exception</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Current_Inventory_Set_Stock_Available_To_False</name>
        <label>Set Current Inventory + Set Stock Available To False</label>
        <locationX>2781</locationX>
        <locationY>714</locationY>
        <assignmentItems>
            <assignToReference>IsStockSufficient</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>COL_InventoryRecordForCurrentItem</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Check_OCI_Stock_Unavailable</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>isStockSufficentForItem</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Existing_Process_Exception</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Filtered_Location</name>
        <label>Set Filtered Location</label>
        <locationX>2456</locationX>
        <locationY>455</locationY>
        <assignmentItems>
            <assignToReference>REC_OrderSummaryLocation</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>L24_Iterate_Over_Filtered_Locations</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>L24_Iterate_Over_Filtered_Locations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Get_Inventory_Availability_Input_Values</name>
        <label>Set Get Inventory Availability Input Values</label>
        <locationX>1535</locationX>
        <locationY>1080</locationY>
        <assignmentItems>
            <assignToReference>REC_OCIGetInventoryAvailabilityInputRepresentation.locationIdentifiers</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>COL_LocationIdentifiers</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>REC_OCIGetInventoryAvailabilityInputRepresentation.stockKeepingUnits</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>COL_SockKeepingUnit</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>REC_OCIGetInventoryAvailabilityInputRepresentation.useCache</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Inventory_Availability</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Inventory_Records_Collection</name>
        <label>Set Inventory Records Collection</label>
        <locationX>3401</locationX>
        <locationY>636</locationY>
        <assignmentItems>
            <assignToReference>COL_InventoryRecords</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>L20_Iterate_Over_Get_Inventory_Availability.inventoryRecords</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_OCI_Stock</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Inventory_Records_Count</name>
        <label>Set Inventory Records Count</label>
        <locationX>3175</locationX>
        <locationY>901</locationY>
        <assignmentItems>
            <assignToReference>InventoryRecordsCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Check_OCI_Stock</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_Inventory_Records_Count</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_success_variable</name>
        <label>Set success variable</label>
        <locationX>1353</locationX>
        <locationY>309</locationY>
        <assignmentItems>
            <assignToReference>recordsFoundSuccess</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>IsStockSufficient</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Update_PE</name>
        <label>Update PE</label>
        <locationX>1993</locationX>
        <locationY>1695</locationY>
        <assignmentItems>
            <assignToReference>Get_Existing_Process_Exception.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FX_PEDescription</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Process_Exception</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_PE_to_Resolved</name>
        <label>Update PE to Resolved</label>
        <locationX>2226</locationX>
        <locationY>1842</locationY>
        <assignmentItems>
            <assignToReference>Get_Existing_Process_Exception.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Resolved</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Process_Exception</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <name>Check_OCI_Stock</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Check OCI Stock</label>
        <locationX>3402</locationX>
        <locationY>898</locationY>
        <assignNextValueToReference>currentItem_Check_OCI_Stock_Unavailable</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>COL_InventoryRecords</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Check_OCI_Stock_Unavailable.onHand</leftValueReference>
            <operator>GreaterThanOrEqualTo</operator>
            <rightValue>
                <elementReference>FX_QtyAllocated_And_AlreadyAllocated</elementReference>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Check_OCI_Stock_Unavailable.stockKeepingUnit</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <elementReference>L22_Iterate_Over_Order_Iem_Summaries.StockKeepingUnit</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Check_OCI_Stock_Unavailable</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Check_OCI_Stock_Unavailable</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Check OCI Stock Unavailable</label>
        <locationX>3292</locationX>
        <locationY>898</locationY>
        <assignNextValueToReference>currentItem_Check_OCI_Stock_Unavailable</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>COL_InventoryRecords</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Check_OCI_Stock_Unavailable.onHand</leftValueReference>
            <operator>LessThan</operator>
            <rightValue>
                <elementReference>FX_QtyAllocated_And_AlreadyAllocated</elementReference>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Check_OCI_Stock_Unavailable.stockKeepingUnit</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <elementReference>L22_Iterate_Over_Order_Iem_Summaries.StockKeepingUnit</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Set_Inventory_Records_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Filter_Location_by_Current_Item</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter Location by Current Item</label>
        <locationX>2409</locationX>
        <locationY>1329</locationY>
        <assignNextValueToReference>currentItem_Filter_Location_by_Current_Item</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Locations</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_Location_by_Current_Item.Id</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <elementReference>L22_Iterate_Over_Order_Iem_Summaries.ReservedAtLocationId</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>LP4_Locations_by_current_Item</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Filter_Location_By_External_Reference</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter Location By External Reference</label>
        <locationX>1930</locationX>
        <locationY>838</locationY>
        <assignNextValueToReference>currentItem_Filter_Location_By_External_Reference</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Locations</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_Location_By_External_Reference.ExternalReference</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <elementReference>L20_Iterate_Over_Get_Inventory_Availability.locationIdentifier</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>L22_Iterate_Over_Order_Iem_Summaries</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Filter_Location_By_Reserved_Location_Id</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter Location By Reserved Location Id</label>
        <locationX>1537</locationX>
        <locationY>305</locationY>
        <assignNextValueToReference>currentItem_Filter_Location_By_Reserved_Location_Id</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Locations</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_Location_By_Reserved_Location_Id.Id</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <elementReference>L10_Iterate_Over_Order_Item_Summaries.ReservedAtLocationId</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>L12_Iterate_Over_Filtered_Location</targetReference>
        </connector>
    </collectionProcessors>
    <decisions>
        <name>Check_Inventory_Records_Count</name>
        <label>Check Inventory Records Count</label>
        <locationX>3053</locationX>
        <locationY>902</locationY>
        <defaultConnector>
            <targetReference>Set_Current_Inventory_Set_Stock_Available_To_False</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Stock Insufficient</defaultConnectorLabel>
        <rules>
            <name>Stock_Sufficient</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InventoryRecordsCount</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Current_Inventory</targetReference>
            </connector>
            <label>Stock Sufficient</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Location_By_Reserved_Location_Id</name>
        <label>Check Location By Reserved Location Id</label>
        <locationX>2632</locationX>
        <locationY>649</locationY>
        <defaultConnector>
            <targetReference>L24_Iterate_Over_Filtered_Locations</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Are Not Equal</defaultConnectorLabel>
        <rules>
            <name>Are_Equal</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>REC_OrderSummaryLocation.Id</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>L22_Iterate_Over_Order_Iem_Summaries.ReservedAtLocationId</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Inventory_Records_Collection</targetReference>
            </connector>
            <label>Are Equal</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Location_Collection</name>
        <label>Check Location Collection</label>
        <locationX>1690</locationX>
        <locationY>50</locationY>
        <defaultConnector>
            <targetReference>Add_Location_Identifer_To_Collection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not Exist</defaultConnectorLabel>
        <rules>
            <name>Is_Already_Exist</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>COL_LocationIdentifiers</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>L12_Iterate_Over_Filtered_Location.ExternalReference</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>L12_Iterate_Over_Filtered_Location</targetReference>
            </connector>
            <label>Is Already Exist</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Stock_Sufficient</name>
        <label>Is Stock Sufficient</label>
        <locationX>1922</locationX>
        <locationY>1383</locationY>
        <defaultConnectorLabel>False</defaultConnectorLabel>
        <rules>
            <name>True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>IsStockSufficient</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>True</label>
        </rules>
    </decisions>
    <decisions>
        <name>Records_Exist</name>
        <label>Records Exist</label>
        <locationX>1346</locationX>
        <locationY>505</locationY>
        <defaultConnector>
            <targetReference>Set_success_variable</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Order_Item_Summaries</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>L10_Iterate_Over_Order_Item_Summaries</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Update_or_Create_PE</name>
        <label>Update or Create PE?</label>
        <locationX>2221</locationX>
        <locationY>1634</locationY>
        <defaultConnector>
            <targetReference>LP4_Locations_by_current_Item</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Update_Active_Process_Exception</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Existing_Process_Exception</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>isStockSufficentForItem</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_PE</targetReference>
            </connector>
            <label>Update Active Process Exception</label>
        </rules>
        <rules>
            <name>Update_Active_Process_Exception_to_Resolved</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Existing_Process_Exception</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>isStockSufficentForItem</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_PE_to_Resolved</targetReference>
            </connector>
            <label>Update Active Process Exception to Resolved</label>
        </rules>
        <rules>
            <name>Create_New_Process_Exception</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Existing_Process_Exception</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>isStockSufficentForItem</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_PE</targetReference>
            </connector>
            <label>Create New Process Exception</label>
        </rules>
    </decisions>
    <formulas>
        <name>FX_PEDescription</name>
        <dataType>String</dataType>
        <expression>BR() + &quot;SKU : &quot; + {!L22_Iterate_Over_Order_Iem_Summaries.StockKeepingUnit} + &quot;, Quantity : &quot; + TEXT( {!L22_Iterate_Over_Order_Iem_Summaries.Quantity} - {!L26_Iterate_Over_Collection_Inventory.availableToOrder}) + &quot;, Location :  &quot; + {!LP4_Locations_by_current_Item.Name}</expression>
    </formulas>
    <formulas>
        <name>FX_QtyAllocated_And_AlreadyAllocated</name>
        <dataType>Number</dataType>
        <expression>{!L22_Iterate_Over_Order_Iem_Summaries.Quantity} + {!Allocated_Qty}</expression>
        <scale>0</scale>
    </formulas>
    <interviewLabel>SOM 210 - Order HD And CC Retry Allocation {!$Flow.CurrentDateTime}</interviewLabel>
    <label>SOM 210 - Order HD And CC Retry Allocation</label>
    <loops>
        <name>L10_Iterate_Over_Order_Item_Summaries</name>
        <label>L10 - Iterate Over Order Item Summaries</label>
        <locationX>1537</locationX>
        <locationY>503</locationY>
        <collectionReference>Get_Order_Item_Summaries</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Filter_Location_By_Reserved_Location_Id</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Set_Get_Inventory_Availability_Input_Values</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>L12_Iterate_Over_Filtered_Location</name>
        <label>L12 - Iterate Over Filtered Location</label>
        <locationX>1695</locationX>
        <locationY>305</locationY>
        <collectionReference>Filter_Location_By_Reserved_Location_Id</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_Location_Collection</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Add_SKU_to_Collection</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>L20_Iterate_Over_Get_Inventory_Availability</name>
        <label>L20 - Iterate Over Get Inventory Availability</label>
        <locationX>1929</locationX>
        <locationY>1080</locationY>
        <collectionReference>REC_OCIGetInventoryAvailabilityOutputRepresentation.locations</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Filter_Location_By_External_Reference</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Is_Stock_Sufficient</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>L22_Allocated_OSLIs</name>
        <label>L22&#39; Allocated OSLIs</label>
        <locationX>2090</locationX>
        <locationY>526</locationY>
        <collectionReference>Get_All_Allocated_OSLIs</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Allocated_Qty</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>L24_Iterate_Over_Filtered_Locations</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>L22_Iterate_Over_Order_Iem_Summaries</name>
        <label>L22 - Iterate Over Order Iem Summaries</label>
        <locationX>2249</locationX>
        <locationY>846</locationY>
        <collectionReference>Get_Order_Item_Summaries</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Reset_Allocated_Qty</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>L20_Iterate_Over_Get_Inventory_Availability</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>L24_Iterate_Over_Filtered_Locations</name>
        <label>L24 - Iterate Over Filtered Locations</label>
        <locationX>2455</locationX>
        <locationY>648</locationY>
        <collectionReference>Filter_Location_By_External_Reference</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Filtered_Location</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Check_Location_By_Reserved_Location_Id</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>L26_Iterate_Over_Collection_Inventory</name>
        <label>L26 - Iterate Over Collection Inventory</label>
        <locationX>2251</locationX>
        <locationY>1073</locationY>
        <collectionReference>COL_InventoryRecordForCurrentItem</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Filter_Location_by_Current_Item</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>L22_Iterate_Over_Order_Iem_Summaries</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>LP4_Locations_by_current_Item</name>
        <label>LP4 Locations by current Item</label>
        <locationX>2227</locationX>
        <locationY>1337</locationY>
        <collectionReference>Filter_Location_by_Current_Item</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Update_or_Create_PE</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>L26_Iterate_Over_Collection_Inventory</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Process_Exceptions</name>
        <label>Create Process Exceptions</label>
        <locationX>2421</locationX>
        <locationY>1459</locationY>
        <connector>
            <targetReference>LP4_Locations_by_current_Item</targetReference>
        </connector>
        <inputReference>V_ProcessExceptionToCreate</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_All_Allocated_OSLIs</name>
        <label>Get All Allocated OSLIs</label>
        <locationX>2090</locationX>
        <locationY>680</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>L22_Allocated_OSLIs</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>StockKeepingUnit</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>L22_Iterate_Over_Order_Iem_Summaries.StockKeepingUnit</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>ALLOCATED</stringValue>
            </value>
        </filters>
        <filters>
            <field>ReservedAtLocationId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>L22_Iterate_Over_Order_Iem_Summaries.ReservedAtLocationId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItemSummary</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Existing_Process_Exception</name>
        <label>Get Existing Process Exception</label>
        <locationX>2780</locationX>
        <locationY>892</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>L26_Iterate_Over_Collection_Inventory</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AttachedToId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>L22_Iterate_Over_Order_Iem_Summaries.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>New</stringValue>
            </value>
        </filters>
        <filters>
            <field>Category</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Fulfillment</stringValue>
            </value>
        </filters>
        <filters>
            <field>OrderSummaryId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>OrderSummaryRecord.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ProcessException</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Locations</name>
        <label>Get Locations</label>
        <locationX>960</locationX>
        <locationY>503</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Order_Item_Summaries</targetReference>
        </connector>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Location</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>ExternalReference</queriedFields>
        <queriedFields>Name</queriedFields>
        <sortField>Id</sortField>
        <sortOrder>Asc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Order_Item_Summaries</name>
        <label>Get Order Item Summaries</label>
        <locationX>1187</locationX>
        <locationY>503</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Records_Exist</targetReference>
        </connector>
        <filterLogic>(1 AND 2 AND 3 AND 6) OR (1 AND 2 AND 4 AND 5 AND 6)</filterLogic>
        <filters>
            <field>OrderSummaryId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>OrderSummaryRecord.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Type</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Order Product</stringValue>
            </value>
        </filters>
        <filters>
            <field>IsPreOrder__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>IsPreOrder__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>DeliveryStartDate__c</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <elementReference>$Flow.InterviewStartTime</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>ORDERED</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItemSummary</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>StockKeepingUnit</queriedFields>
        <queriedFields>ReservedAtLocationId</queriedFields>
        <queriedFields>Quantity</queriedFields>
        <queriedFields>OrderSummaryId</queriedFields>
        <sortField>CreatedDate</sortField>
        <sortOrder>Asc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Process_Exception</name>
        <label>Update Process Exception</label>
        <locationX>1845</locationX>
        <locationY>1841</locationY>
        <connector>
            <targetReference>LP4_Locations_by_current_Item</targetReference>
        </connector>
        <inputReference>Get_Existing_Process_Exception</inputReference>
    </recordUpdates>
    <start>
        <locationX>832</locationX>
        <locationY>366</locationY>
        <connector>
            <targetReference>Get_Locations</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>Allocated_Qty</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>C_ProcessExceptionsToCreate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProcessException</objectType>
    </variables>
    <variables>
        <name>COL_InventoryRecordForCurrentItem</name>
        <apexClass>ConnectApi__OCIInventoryRecordOutputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>COL_InventoryRecords</name>
        <apexClass>ConnectApi__OCIInventoryRecordOutputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>COL_LocationIdentifiers</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>COL_SockKeepingUnit</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>currentItem_Check_OCI_Stock_Unavailable</name>
        <apexClass>ConnectApi__OCIInventoryRecordOutputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>currentItem_Filter_Invenory_Records</name>
        <apexClass>ConnectApi__OCIInventoryRecordOutputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>currentItem_Filter_Location_by_Current_Item</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_Location_By_External_Reference</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_Location_By_Reserved_Location_Id</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <name>InventoryRecordsCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>isStockSufficentForItem</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>true</booleanValue>
        </value>
    </variables>
    <variables>
        <name>IsStockSufficient</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <value>
            <booleanValue>true</booleanValue>
        </value>
    </variables>
    <variables>
        <name>OrderSummaryRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderSummary</objectType>
    </variables>
    <variables>
        <name>PEDescription</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Error Allocating Products :</stringValue>
        </value>
    </variables>
    <variables>
        <name>REC_OCIGetInventoryAvailabilityInputRepresentation</name>
        <apexClass>ConnectApi__OCIGetInventoryAvailabilityInputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>REC_OCIGetInventoryAvailabilityOutputRepresentation</name>
        <apexClass>ConnectApi__OCIGetInventoryAvailabilityOutputRepresentation</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>REC_OrderSummaryLocation</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <name>recordsFoundSuccess</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <value>
            <booleanValue>true</booleanValue>
        </value>
    </variables>
    <variables>
        <name>V_ProcessExceptionToCreate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProcessException</objectType>
    </variables>
</Flow>
